<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1a1a2e">
    <title>×“×©×‘×•×¨×“ ×—×™×™×©× ×™×</title>
    <style>
        :root {
            --bg: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            --card: rgba(255,255,255,0.05);
            --text: #fff;
            --muted: #8892b0;
            --accent: #ffd700;
            --green: #64ffda;
            --gauge: min(38vw, 180px);
        }
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI',sans-serif; }
        body { background:var(--bg); min-height:100vh; color:var(--text); padding:clamp(8px,2vw,20px); }
        
        .header { text-align:center; margin-bottom:clamp(10px,3vw,25px); }
        .header h1 { font-size:clamp(1.1rem,4vw,2rem); color:var(--accent); }
        .header .time { font-size:clamp(0.7rem,2vw,1rem); color:var(--muted); margin-top:5px; }
        
        .grid { display:grid; grid-template-columns:repeat(2,1fr); gap:clamp(8px,2vw,20px); max-width:100%; }
        
        .card {
            background:var(--card); border-radius:clamp(10px,2vw,20px);
            padding:clamp(10px,2vw,20px); border:1px solid rgba(255,255,255,0.1);
        }
        .card-title { text-align:center; font-size:clamp(0.75rem,2.5vw,1.1rem); margin-bottom:clamp(8px,2vw,15px); }
        .icon { font-size:clamp(0.9rem,3vw,1.3rem); margin-left:5px; }
        
        .gauge { position:relative; width:var(--gauge); height:var(--gauge); margin:0 auto; }
        .gauge svg { transform:rotate(-90deg); width:100%; height:100%; }
        .gauge-bg { fill:none; stroke:rgba(255,255,255,0.1); stroke-width:10; }
        .gauge-fill { fill:none; stroke-width:10; stroke-linecap:round; transition:stroke-dashoffset 0.5s; }
        .gauge-fill.gas { stroke:#ff6b6b; }
        .gauge-fill.water { stroke:#4facfe; }
        .gauge-fill.elec { stroke:#f9d423; }
        .gauge-fill.temp { stroke:#667eea; }
        
        .gauge-center {
            position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); text-align:center;
        }
        .value { font-size:clamp(1.3rem,5vw,2.2rem); font-weight:bold; color:var(--accent); }
        .unit { font-size:clamp(0.6rem,1.5vw,0.85rem); color:var(--muted); }
        
        .stats { margin-top:clamp(8px,2vw,15px); padding-top:clamp(8px,1.5vw,12px); border-top:1px solid rgba(255,255,255,0.1); text-align:center; }
        .monthly { font-size:clamp(0.9rem,3vw,1.4rem); color:var(--green); font-weight:bold; }
        .label { font-size:clamp(0.6rem,1.5vw,0.75rem); color:var(--muted); margin-top:3px; }
        
        .bar { height:clamp(4px,1vw,8px); background:rgba(255,255,255,0.1); border-radius:10px; margin-top:8px; overflow:hidden; }
        .bar-fill { height:100%; border-radius:10px; transition:width 0.5s; }
        .bar-fill.gas { background:linear-gradient(90deg,#ff6b6b,#ffa06b); }
        .bar-fill.water { background:linear-gradient(90deg,#4facfe,#00f2fe); }
        .bar-fill.elec { background:linear-gradient(90deg,#f9d423,#ff4e50); }
        .bar-fill.temp { background:linear-gradient(90deg,#667eea,#764ba2); }
        
        .pct { display:flex; justify-content:space-between; font-size:clamp(0.55rem,1.3vw,0.7rem); color:var(--muted); margin-top:4px; }
        .update { font-size:clamp(0.5rem,1.2vw,0.65rem); color:var(--muted); text-align:center; margin-top:8px; }
        
        .footer { text-align:center; margin-top:20px; font-size:clamp(0.6rem,1.5vw,0.8rem); color:var(--muted); }
        
        .settings-btn {
            position:fixed; bottom:15px; left:15px; width:clamp(36px,8vw,45px); height:clamp(36px,8vw,45px);
            border-radius:50%; background:rgba(255,215,0,0.2); border:2px solid var(--accent);
            color:var(--accent); font-size:clamp(1rem,3vw,1.3rem); cursor:pointer;
        }
        .panel {
            display:none; position:fixed; bottom:65px; left:15px; right:15px; max-width:300px;
            background:rgba(26,26,46,0.95); border-radius:15px; padding:15px;
            border:1px solid rgba(255,215,0,0.3); max-height:60vh; overflow-y:auto;
        }
        .panel.open { display:block; }
        .panel h3 { color:var(--accent); margin-bottom:12px; font-size:clamp(0.85rem,2vw,1rem); }
        .input-group { margin-bottom:12px; }
        .input-group label { display:block; font-size:clamp(0.65rem,1.5vw,0.8rem); color:var(--muted); margin-bottom:4px; }
        .input-group input {
            width:100%; padding:8px; border-radius:8px; border:1px solid rgba(255,255,255,0.2);
            background:rgba(255,255,255,0.1); color:#fff; font-size:clamp(0.7rem,1.5vw,0.85rem);
        }
        .btn { width:100%; padding:10px; background:var(--accent); border:none; border-radius:8px; color:#1a1a2e; font-weight:bold; cursor:pointer; margin-top:8px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ  ×“×©×‘×•×¨×“ ×—×™×™×©× ×™ ×”×‘×™×ª</h1>
        <div class="time" id="time"></div>
    </div>

    <div class="grid">
        <!-- ×’×– -->
        <div class="card">
            <div class="card-title"><span class="icon">ğŸ”¥</span>×’×–</div>
            <div class="gauge">
                <svg viewBox="0 0 100 100">
                    <circle class="gauge-bg" cx="50" cy="50" r="40"/>
                    <circle class="gauge-fill gas" id="gasGauge" cx="50" cy="50" r="40" stroke-dasharray="251.2" stroke-dashoffset="251.2"/>
                </svg>
                <div class="gauge-center">
                    <div class="value" id="gasVal">0</div>
                    <div class="unit">mÂ³/×©</div>
                </div>
            </div>
            <div class="stats">
                <div class="monthly" id="gasMonth">0 mÂ³</div>
                <div class="label">×¡×”"×› ×”×—×•×“×©</div>
                <div class="bar"><div class="bar-fill gas" id="gasBar"></div></div>
                <div class="pct"><span>×™×¢×“: 50 mÂ³</span><span id="gasPct">0%</span></div>
            </div>
            <div class="update">×¢×“×›×•×Ÿ: <span id="gasTime">--</span></div>
        </div>

        <!-- ××™× -->
        <div class="card">
            <div class="card-title"><span class="icon">ğŸ’§</span>××™×</div>
            <div class="gauge">
                <svg viewBox="0 0 100 100">
                    <circle class="gauge-bg" cx="50" cy="50" r="40"/>
                    <circle class="gauge-fill water" id="waterGauge" cx="50" cy="50" r="40" stroke-dasharray="251.2" stroke-dashoffset="251.2"/>
                </svg>
                <div class="gauge-center">
                    <div class="value" id="waterVal">0</div>
                    <div class="unit">×œ'/×“</div>
                </div>
            </div>
            <div class="stats">
                <div class="monthly" id="waterMonth">0 mÂ³</div>
                <div class="label">×¡×”"×› ×”×—×•×“×©</div>
                <div class="bar"><div class="bar-fill water" id="waterBar"></div></div>
                <div class="pct"><span>×™×¢×“: 15 mÂ³</span><span id="waterPct">0%</span></div>
            </div>
            <div class="update">×¢×“×›×•×Ÿ: <span id="waterTime">--</span></div>
        </div>

        <!-- ×—×©××œ -->
        <div class="card">
            <div class="card-title"><span class="icon">âš¡</span>×—×©××œ</div>
            <div class="gauge">
                <svg viewBox="0 0 100 100">
                    <circle class="gauge-bg" cx="50" cy="50" r="40"/>
                    <circle class="gauge-fill elec" id="elecGauge" cx="50" cy="50" r="40" stroke-dasharray="251.2" stroke-dashoffset="251.2"/>
                </svg>
                <div class="gauge-center">
                    <div class="value" id="elecVal">0</div>
                    <div class="unit">×•×•××˜</div>
                </div>
            </div>
            <div class="stats">
                <div class="monthly" id="elecMonth">0 kWh</div>
                <div class="label">×¡×”"×› ×”×—×•×“×©</div>
                <div class="bar"><div class="bar-fill elec" id="elecBar"></div></div>
                <div class="pct"><span>×™×¢×“: 500 kWh</span><span id="elecPct">0%</span></div>
            </div>
            <div class="update">×¢×“×›×•×Ÿ: <span id="elecTime">--</span></div>
        </div>

        <!-- ×˜××¤×¨×˜×•×¨×” -->
        <div class="card">
            <div class="card-title"><span class="icon">ğŸŒ¡ï¸</span>×“×•×“ ××™×</div>
            <div class="gauge">
                <svg viewBox="0 0 100 100">
                    <circle class="gauge-bg" cx="50" cy="50" r="40"/>
                    <circle class="gauge-fill temp" id="tempGauge" cx="50" cy="50" r="40" stroke-dasharray="251.2" stroke-dashoffset="251.2"/>
                </svg>
                <div class="gauge-center">
                    <div class="value" id="tempVal">0</div>
                    <div class="unit">Â°C</div>
                </div>
            </div>
            <div class="stats">
                <div class="monthly" id="tempAvg">0Â°C</div>
                <div class="label">×××•×¦×¢ ×™×•××™</div>
                <div class="bar"><div class="bar-fill temp" id="tempBar"></div></div>
                <div class="pct"><span>55-65Â°C</span><span id="tempStatus">×ª×§×™×Ÿ</span></div>
            </div>
            <div class="update">×¢×“×›×•×Ÿ: <span id="tempTime">--</span></div>
        </div>
    </div>

    <div class="footer">××¢×¨×›×ª × ×™×˜×•×¨ ×—×™×™×©× ×™× | Tuya Smart</div>

    <button class="settings-btn" id="setBtn">âš™ï¸</button>
    <div class="panel" id="panel">
        <h3>âš™ï¸ ×”×’×“×¨×•×ª Tuya</h3>
        <div class="input-group">
            <label>Access ID</label>
            <input type="text" id="accessId" placeholder="×”×–×Ÿ Access ID">
        </div>
        <div class="input-group">
            <label>Access Secret</label>
            <input type="password" id="accessSecret" placeholder="×”×–×Ÿ Access Secret">
        </div>
        <div class="input-group">
            <label>Device ID - ×’×–</label>
            <input type="text" id="devGas" placeholder="Device ID">
        </div>
        <div class="input-group">
            <label>Device ID - ××™×</label>
            <input type="text" id="devWater" placeholder="Device ID">
        </div>
        <div class="input-group">
            <label>Device ID - ×—×©××œ</label>
            <input type="text" id="devElec" placeholder="Device ID">
        </div>
        <div class="input-group">
            <label>Device ID - ×˜××¤×¨×˜×•×¨×”</label>
            <input type="text" id="devTemp" placeholder="Device ID">
        </div>
        <button class="btn" onclick="saveSettings()">ğŸ’¾ ×©××•×¨</button>
    </div>

    <script>
        // Data
        let data = {
            gas: { val: 1.25, month: 28.5 },
            water: { val: 8.3, month: 9.2 },
            elec: { val: 1450, month: 385 },
            temp: { val: 58, avg: 59 }
        };
        const targets = { gas: 50, water: 15, elec: 500 };

        // Update gauge
        function setGauge(id, pct) {
            const el = document.getElementById(id);
            if (el) el.style.strokeDashoffset = 251.2 - (Math.min(pct,100)/100) * 251.2;
        }

        // Update display
        function update() {
            const t = new Date().toLocaleTimeString('he-IL');
            
            // Gas
            document.getElementById('gasVal').textContent = data.gas.val;
            document.getElementById('gasMonth').textContent = data.gas.month + ' mÂ³';
            const gp = (data.gas.month / targets.gas) * 100;
            document.getElementById('gasBar').style.width = Math.min(gp,100) + '%';
            document.getElementById('gasPct').textContent = gp.toFixed(0) + '%';
            document.getElementById('gasTime').textContent = t;
            setGauge('gasGauge', gp);

            // Water
            document.getElementById('waterVal').textContent = data.water.val;
            document.getElementById('waterMonth').textContent = data.water.month + ' mÂ³';
            const wp = (data.water.month / targets.water) * 100;
            document.getElementById('waterBar').style.width = Math.min(wp,100) + '%';
            document.getElementById('waterPct').textContent = wp.toFixed(0) + '%';
            document.getElementById('waterTime').textContent = t;
            setGauge('waterGauge', wp);

            // Electricity
            document.getElementById('elecVal').textContent = data.elec.val;
            document.getElementById('elecMonth').textContent = data.elec.month + ' kWh';
            const ep = (data.elec.month / targets.elec) * 100;
            document.getElementById('elecBar').style.width = Math.min(ep,100) + '%';
            document.getElementById('elecPct').textContent = ep.toFixed(0) + '%';
            document.getElementById('elecTime').textContent = t;
            setGauge('elecGauge', ep);

            // Temperature
            document.getElementById('tempVal').textContent = data.temp.val;
            document.getElementById('tempAvg').textContent = data.temp.avg + 'Â°C';
            const tp = (data.temp.val / 80) * 100;
            document.getElementById('tempBar').style.width = Math.min(tp,100) + '%';
            let status = 'âœ… ×ª×§×™×Ÿ';
            if (data.temp.val < 55) status = 'â„ï¸ ×§×¨';
            else if (data.temp.val > 65) status = 'ğŸ”¥ ×—×';
            document.getElementById('tempStatus').textContent = status;
            document.getElementById('tempTime').textContent = t;
            setGauge('tempGauge', tp);
        }

        // Simulate data
        function simulate() {
            const d = new Date().getDate();
            data.gas.val = (0.5 + Math.random() * 1.5).toFixed(2);
            data.water.val = (2 + Math.random() * 12).toFixed(1);
            data.elec.val = Math.floor(800 + Math.random() * 2000);
            data.temp.val = Math.floor(50 + Math.random() * 18);
            
            data.gas.month = (d * 1.2 + Math.random() * 5).toFixed(1);
            data.water.month = (d * 0.35 + Math.random() * 2).toFixed(1);
            data.elec.month = Math.floor(d * 14 + Math.random() * 40);
            data.temp.avg = Math.floor(55 + Math.random() * 8);
            
            update();
            try { localStorage.setItem('sensorData', JSON.stringify(data)); } catch(e) {}
        }

        // Time
        function updateTime() {
            const now = new Date();
            const opts = { weekday:'long', day:'numeric', month:'long', hour:'2-digit', minute:'2-digit' };
            document.getElementById('time').textContent = now.toLocaleDateString('he-IL', opts);
        }

        // Settings
        document.getElementById('setBtn').addEventListener('click', () => {
            document.getElementById('panel').classList.toggle('open');
        });
        
        function saveSettings() {
            const settings = {
                accessId: document.getElementById('accessId').value,
                accessSecret: document.getElementById('accessSecret').value,
                devices: {
                    gas: document.getElementById('devGas').value,
                    water: document.getElementById('devWater').value,
                    elec: document.getElementById('devElec').value,
                    temp: document.getElementById('devTemp').value
                }
            };
            try { localStorage.setItem('tuyaSettings', JSON.stringify(settings)); } catch(e) {}
            document.getElementById('panel').classList.remove('open');
            alert('×”×’×“×¨×•×ª × ×©××¨×•!');
        }

        // Load saved data
        try {
            const saved = localStorage.getItem('sensorData');
            if (saved) data = JSON.parse(saved);
            const settings = localStorage.getItem('tuyaSettings');
            if (settings) {
                const s = JSON.parse(settings);
                document.getElementById('accessId').value = s.accessId || '';
                document.getElementById('accessSecret').value = s.accessSecret || '';
                document.getElementById('devGas').value = s.devices?.gas || '';
                document.getElementById('devWater').value = s.devices?.water || '';
                document.getElementById('devElec').value = s.devices?.elec || '';
                document.getElementById('devTemp').value = s.devices?.temp || '';
            }
        } catch(e) {}

        // Start
        updateTime();
        update();
        simulate();
        setInterval(updateTime, 1000);
        setInterval(simulate, 3000);
    </script>
</body>
</html>
